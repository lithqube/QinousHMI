<?xml version="1.0" encoding="UTF-8"?>
<html xmlns:atv="http://webmi.atvise.com/2007/svgext" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:svg="http://www.w3.org/2000/svg" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <title></title>
  <style>v\:*{behavior:url(#default#VML)}body{overflow:hidden}</style>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
 </head>
 <body>
  <v:group atv:coordfactor="100" atv:oe="2BC6E3BA9386L2KEE9ICI6H8M7O4P31F365AECD499I181IBLDHCP3HBN5KFQDC83" coordsize="96400,60000" id="webmivmlroot" style="height:600px;left:0;position:absolute;top:0;visibility:hidden;width:964px">
   <v:polyline fillcolor="#bacd69" id="id_31" points="9600,4300 33600,27900 23500,5800 49100,3900 75200,56400 82700,42800 81100,22100 9500,56800 34000,46400 94000,12800 48100,10300 11300,25500 85100,12000 9600,4300 " strokecolor="#f8e9a2" stroked="true" strokeweight="3.75"/>
   <v:line fillcolor="#b88d01" from="17600,47800" id="id_25" strokecolor="#1ecc69" stroked="true" strokeweight="3.75" to="9200,29600">
    <v:stroke joinstyle="miter"/>
   </v:line>
   <v:line fillcolor="#fe9311" from="62700,44400" id="id_18" strokecolor="#fa4664" stroked="true" strokeweight="0.75" to="95700,30300">
    <v:stroke joinstyle="miter"/>
   </v:line>
   <v:line fillcolor="#529831" from="40000,26100" id="id_14" strokecolor="#6a739f" stroked="true" strokeweight="0.75" to="53100,0">
    <v:stroke joinstyle="miter"/>
   </v:line>
   <v:line atv:refpx="2414" atv:refpy="1645" from="1700 1533" id="id_3" to="201700 1633">
    <v:skew matrix="0.94,0,0,0.94" on="true" origin="-0.5085,-15.83333"/>
    <v:path textpathok="true"/>
    <v:fill color="#647a8f" on="true"/>
    <v:stroke on="false"/>
    <v:textpath on="true" string="HVAC AND ENVIRONMENT" style="font-family:'Varela Round';font-size:20px;v-text-align:left"/>
   </v:line>
   <v:polyline fillcolor="#bd4c55" id="id_11" points="50400,4100 49000,54300 79800,17600 70800,34200 16500,24100 6100,2700 42900,17300 " strokecolor="#a3385c" stroked="true" strokeweight="3.75">
    <v:stroke joinstyle="miter"/>
   </v:polyline>
   <v:polyline fillcolor="#0b07aa" id="id_9" points="50400,27300 92000,28200 36100,38300 38400,11500 84300,9100 68500,18000 88500,18200 50000,40300 14400,45400 50400,27300 " strokecolor="#3e4a46" stroked="true" strokeweight="0.75"/>
   <v:rect fillcolor="#18d377" id="id_7" strokecolor="#8c2726" stroked="true" strokeweight="3.75" style="height:800px;left:42900px;top:57800px;width:25000px"/>
   <v:oval fillcolor="#567484" id="id_2" strokecolor="#2d945a" stroked="true" strokeweight="2.25" style="height:25200px;left:-34100px;top:16900px;width:87200px"/>
   <v:polyline fillcolor="#cbb420" id="id_30" points="31700,31300 10900,37800 59500,57600 24200,45900 7000,34700 26000,13500 " strokecolor="#5d242c" stroked="true" strokeweight="2.25">
    <v:stroke joinstyle="miter"/>
   </v:polyline>
   <v:line fillcolor="#0e9330" from="93300,25300" id="id_28" strokecolor="#4d8689" stroked="true" strokeweight="1.5" to="2700,52500">
    <v:stroke joinstyle="miter"/>
   </v:line>
   <v:oval fillcolor="#a2bc8f" id="id_26" strokecolor="#0ad891" stroked="true" strokeweight="3.75" style="height:49200px;left:13000px;top:-16400px;width:49200px"/>
   <v:oval fillcolor="#707737" id="id_24" strokecolor="#6279e4" stroked="true" strokeweight="2.25" style="height:20800px;left:100px;top:11000px;width:75000px"/>
   <v:oval fillcolor="#9ad5f5" id="id_20" strokecolor="#d3af8f" stroked="true" strokeweight="3.75" style="height:49200px;left:12700px;top:34000px;width:49200px"/>
   <v:group atv:origtransform="matrix(0.94,0,0,0.94,116.0149,32.8994)" atv:refpx="59833" atv:refpy="28819" atv:table-height="260" atv:table-width="640" coordorigin="1000,400" coordsize="121427,75740" id="commands" style="height:75740px;left:1000px;top:400px;width:121427px">
    <v:line fillcolor="#41b0af" from="84827,29798" id="id_33" strokecolor="#fc2736" stroked="true" strokeweight="3.52" to="55405,44650">
     <v:stroke joinstyle="miter"/>
    </v:line>
    <v:polyline atv:matrix="0.94,0,0,0.94,116.0149,32.8994" fillcolor="#fcb3d4" id="id_32" points="34631,8366 99209,13630 84169,47000 96107,7708 41775,7144 54559,30738 27957,25944 80409,10246 88775,19176 46663,47940 48261,21244 61139,23406 19497,48974 " strokecolor="#93ff19" stroked="true" strokeweight="2.82">
     <v:stroke joinstyle="miter"/>
    </v:polyline>
    <v:polyline atv:matrix="0.94,0,0,0.94,116.0149,32.8994" fillcolor="#f4f426" id="id_29" points="89433,42206 36699,24158 62079,12126 44219,57434 81913,51700 82853,34874 38485,3666 46945,53204 74393,16074 12541,10810 82571,33746 19779,9682 " strokecolor="#3e2d3a" stroked="true" strokeweight="1.41">
     <v:stroke joinstyle="miter"/>
    </v:polyline>
    <v:oval fillcolor="#92ec79" id="id_27" strokecolor="#96a501" stroked="true" strokeweight="2.11" style="height:34968px;left:84639px;top:41172px;width:34968px"/>
    <v:rect fillcolor="#249ebc" id="id_23" strokecolor="#5c1c1c" stroked="true" strokeweight="2.11" style="height:22560px;left:32281px;top:34216px;width:35250px"/>
    <v:oval fillcolor="#8f8b68" id="id_22" strokecolor="#024567" stroked="true" strokeweight="3.52" style="height:1504px;left:42903px;top:19082px;width:1504px"/>
    <v:roundrect arcsize="0.008" atv:refpx="86801" atv:refpy="31490" id="rect1" stroked="false" strokeweight="0.94" style="height:56400px;left:11601px;top:3290px;width:84600px"/>
    <v:oval fillcolor="#9e6d33" id="id_21" strokecolor="#7aceeb" stroked="true" strokeweight="2.82" style="height:40796px;left:72419px;top:12502px;width:50008px"/>
    <v:polyline atv:matrix="0.94,0,0,0.94,116.0149,32.8994" fillcolor="#157123" id="id_13" points="49295,52734 38015,22936 82007,26320 82477,47564 23539,35344 94603,14476 88587,9212 68659,30738 54935,20022 34725,24534 83041,36848 52303,31960 67061,39198 49295,52734 " strokecolor="#9d1c1d" stroked="true" strokeweight="2.82"/>
    <v:oval fillcolor="#aefaa0" id="id_12" strokecolor="#ce0eea" stroked="true" strokeweight="2.11" style="height:35908px;left:79939px;top:16544px;width:35908px"/>
    <v:line fillcolor="#17083b" from="27675,50478" id="id_10" strokecolor="#5d88ae" stroked="true" strokeweight="2.82" to="41399,43804">
     <v:stroke joinstyle="miter"/>
    </v:line>
    <v:polyline atv:matrix="0.94,0,0,0.94,116.0149,32.8994" fillcolor="#1c399b" id="id_8" points="33691,21150 89245,20022 38955,39010 27017,22654 53995,36472 33691,21150 " strokecolor="#45174d" stroked="true" strokeweight="1.41"/>
    <v:rect fillcolor="#ad5c87" id="id_6" strokecolor="#b5219f" stroked="true" strokeweight="3.52" style="height:94px;left:87553px;top:59596px;width:10810px"/>
    <v:line fillcolor="#cd5a0f" from="31999,43334" id="id_4" strokecolor="#5638fc" stroked="true" strokeweight="2.11" to="80127,18330">
     <v:stroke joinstyle="miter"/>
    </v:line>
   </v:group>
  </v:group>
  <script type="text/javascript" src="../../webmi.js"></script>
  <script type="text/javascript" src="/q/TableFunctions.js"></script>
  <script type="text/javascript" src="/q/StdConstantsFunctions.js"></script>
  <script type="text/javascript">//<![CDATA[
webMI.proxy({"":[function(webMI,window,document,self){var $ = top.$;
var enviroHeaders = [];
var	RowHeight = 30,
	linefill = "#FFFFFF",
	columnfill = "#FFFFFF"; //EEF1F2

getRowFunction = function(col, table){

	return function(dp) {

		var curData = table.dataProvider().source.data;
		for (var i=0; i<curData.length; i++) {	
			if(curData[i][col].dp == dp) {
//				console.log("Updating row ", i, " for dp ", dp);
				return i +1;
			}
		};
	}
}

// setup blank tables
//console.log("Setting up tables...");
var enviroTable = webMI.callExtension("SYSTEM.LIBRARY.ATVISE.QUICKDYNAMICS.Table", { "gElement": document.getElementById("commands"),"sortedByColumn":0, "autoResize":true, "height":600, "width":900});
enviroTable.setConfiguration({rowHeight:RowHeight, sortingUp:false, drawStatusBar:false});
enviroHeaders.push({name: "Component ", width: 400, fontSize: fontSize});
enviroHeaders.push({name: "Type", width: 200, fontSize: fontSize});
enviroHeaders.push({name: "Value", width: 180, fontSize: fontSize});
enviroHeaders.push({name: "Unit", width: 110, fontSize: fontSize});
enviroTable.setHeaders(enviroHeaders);


function initializeEnviroTable(valueList, table){

	//initialize table
	var nodearray = [];
	for (var i=0; i<valueList.length; i++) {	
//		console.log("=====================================Looking at : ", valueList[i]);
		var datarow = [];
	
		datarow[0] = {text: valueList[i].ComponentName, fill:linefill, fontSize: fontcolumn};
		datarow[1] = {text: valueList[i].ComponentType, fill:linefill, fontSize: fontcolumn};
		datarow[2] = {text: "...", fill:linefill, dp:valueList[i].DP};
		datarow[3] = {text: valueList[i].Unit, fill:linefill, fontSize: fontcolumn};
		nodearray[i] = datarow;	
	}
	table.setDataProvider({data: nodearray});

	//Set Update Function
	for (var i=0; i<valueList.length; i++) {
		addSubscribe(3, getRowFunction(2, table), valueList[i].DP, valueList[i].Type, table);
	}
}


var enviroModule = "/QC_DELTA/";

var EnviroMonitoringValues =[

{ComponentName: "System Running", DP: enviroModule +".DeltaTherm_CoolingValues.System_On", ComponentType: "System", Type: "BOOL", Unit: ""},
{ComponentName: "Pump 1 Running", DP: enviroModule +".DeltaTherm_CoolingValues.Pump_Circuit_1_On", ComponentType: "Pump", Type: "BOOL", Unit: ""},
{ComponentName: "Pump 2 Running", DP: enviroModule +".DeltaTherm_CoolingValues.Pump_Circuit_2_On", ComponentType: "Pump", Type: "BOOL", Unit: ""},
{ComponentName: "Compressor Running", DP: enviroModule +".DeltaTherm_CoolingValues.Compressor_On", ComponentType: "Compressor", Type: "BOOL", Unit: ""},
{ComponentName: "Low Pressure in Circuit", DP: enviroModule +".DeltaTherm_CoolingValues.Alarm_ND_CoolCircuit", ComponentType: "Alarm", Type: "BOOL", Unit: ""},
{ComponentName: "High Pressure in Circuit", DP: enviroModule +".DeltaTherm_CoolingValues.Alarm_HD_CoolCircuit", ComponentType: "Alarm", Type: "BOOL", Unit: ""},
{ComponentName: "Compressor Error", DP: enviroModule +".DeltaTherm_CoolingValues.Alarm_Compressor", ComponentType: "Alarm", Type: "BOOL", Unit: ""},
{ComponentName: "Valve Error", DP: enviroModule +".DeltaTherm_CoolingValues.Alarm_valve", ComponentType: "Alarm", Type: "BOOL", Unit: ""},
{ComponentName: "Pump 1 Error", DP: enviroModule +".DeltaTherm_CoolingValues.Alarm_Pump_1", ComponentType: "Alarm", Type: "BOOL", Unit: ""},
{ComponentName: "Pump 2 Error", DP: enviroModule +".DeltaTherm_CoolingValues.Alarm_Pump_2", ComponentType: "Alarm", Type: "BOOL", Unit: ""},
{ComponentName: "Dry Operation Error", DP: enviroModule +".DeltaTherm_CoolingValues.Alarm_Dry_Running", ComponentType: "Alarm", Type: "BOOL", Unit: ""},
{ComponentName: "Heater Error", DP: enviroModule +".DeltaTherm_CoolingValues.Alarm_Protect_Heater", ComponentType: "Alarm", Type: "BOOL", Unit: ""},
{ComponentName: "STB Heater Error", DP: enviroModule +".DeltaTherm_CoolingValues.Alarm_STB_Heater", ComponentType: "Alarm", Type: "BOOL", Unit: ""},
{ComponentName: "Frost Protection Error", DP: enviroModule +".DeltaTherm_CoolingValues.Alarm_Frost_Protect", ComponentType: "Alarm", Type: "BOOL", Unit: ""},
{ComponentName: "Temperature Circuit 1 Low", DP: enviroModule +".DeltaTherm_CoolingValues.Temp_Circuit_1_Low", ComponentType: "Alarm", Type: "BOOL", Unit: ""},
{ComponentName: "Temperature Circuit 1 High", DP: enviroModule +".DeltaTherm_CoolingValues.Temp_Circuit_1_High", ComponentType: "Alarm", Type: "BOOL", Unit: ""},
{ComponentName: "Temperature Circuit 2 Low", DP: enviroModule +".DeltaTherm_CoolingValues.Temp_Circuit_2_Low", ComponentType: "Alarm", Type: "BOOL", Unit: ""},
{ComponentName: "Temperature Circuit 2 High", DP: enviroModule +".DeltaTherm_CoolingValues.Temp_Circuit_2_High", ComponentType: "Alarm", Type: "BOOL", Unit: ""},
{ComponentName: "Setpoint Circuit 2", DP: enviroModule +".DeltaTherm_CoolingValues.Setpoint_Circuit_2", ComponentType: "Temperature", Type: "REAL", Unit: "°C"},
{ComponentName: "Setpoint Tank", DP: enviroModule +".DeltaTherm_CoolingValues.Setpoint_Tank", ComponentType: "Temperature", Type: "REAL", Unit: "°C"},
{ComponentName: "Tank Temperature", DP: enviroModule +".DeltaTherm_CoolingValues.Temp_Tank", ComponentType: "Temperature", Type: "REAL", Unit: "°C"},
{ComponentName: "Temperature flowing Circuit 2", DP: enviroModule +".DeltaTherm_CoolingValues.Temp_flow_Circuit_2", ComponentType: "Temperature", Type: "REAL", Unit: "°C"},
{ComponentName: "Temperature Return Circuit_2", DP: enviroModule +".DeltaTherm_CoolingValues.Temp_Return_Circuit_2", ComponentType: "Temperature", Type: "REAL", Unit: "°C"},

{ComponentName: "Inverter Ready", DP: enviroModule +".Controller_IOs[1].State", ComponentType: "System", Type: "BOOL", Unit: ""},

{ComponentName: "NO Cooling Water Level Low", DP: enviroModule +".Controller_IOs[2].State", ComponentType: "Alarm", Type: "BOOL", Unit: ""},


{ComponentName: "Cooling Fan 1", DP: enviroModule +".Controller_IOs[4].State", ComponentType: "System", Type: "BOOL", Unit: ""},
{ComponentName: "Cooling Fan 2", DP: enviroModule +".Controller_IOs[5].State", ComponentType: "System", Type: "BOOL", Unit: ""},
{ComponentName: "Valve Cooling Water Open", DP: enviroModule +".Controller_IOs[6].State", ComponentType: "System", Type: "BOOL", Unit: ""},

{ComponentName: "Temperature Returnflow Inverter", DP: enviroModule +".Controller_IOs[7].Average", ComponentType: "Temperature", Type: "REAL", Unit: "°C"},
{ComponentName: "Environment Temperature", DP: enviroModule +".Controller_IOs[8].Average", ComponentType: "Temperature", Type: "REAL", Unit: "°C"},
{ComponentName: "Indoor 1 Temperature", DP: enviroModule +".Controller_IOs[9].Average", ComponentType: "Temperature", Type: "REAL", Unit: "°C"},
{ComponentName: "Indoor 2 Temperature", DP: enviroModule +".Controller_IOs[10].Average", ComponentType: "Temperature", Type: "REAL", Unit: "°C"},
{ComponentName: "Temperature Transformator Room", DP: enviroModule +".Controller_IOs[11].Average", ComponentType: "Temperature", Type: "REAL", Unit: "°C"},
{ComponentName: "Dew Point Battery Room", DP: enviroModule +".Controller_IOs[12].Average", ComponentType: "Temperature", Type: "REAL", Unit: "°C"},
{ComponentName: "Fan HVAC", DP: enviroModule +".Controller_IOs[14].Average", ComponentType: "System", Type: "REAL", Unit: "°C"},

{ComponentName: "Bypass Valve", DP: enviroModule +".Controller_IOs[15].Value", ComponentType: "System", Type: "REAL", Unit: "%"},

{ComponentName: "Heater ON", DP: enviroModule +".Controller_IOs[16].State", ComponentType: "System", Type: "BOOL", Unit: ""},

{ComponentName: "Dewing Hysterese Warning", DP: enviroModule +".Controller_IOs[17].State", ComponentType: "Temperature", Type: "REAL", Unit: "°C"},
{ComponentName: "Solar Sensor", DP: enviroModule +".Controller_IOs[20].State", ComponentType: "System", Type: "REAL", Unit: "W/m2"},

]



initializeEnviroTable(EnviroMonitoringValues, enviroTable);


webMI.callExtension("SYSTEM.LIBRARY.PROJECT.QUICKDYNAMICS.Theme", {"action":"font family", "defaultValue":"font family", "id":"id_3", "key":"FontFamily", "property":""});
},{},{}]},window);
//]]></script>
 </body>
</html>
