<?xml version="1.0" encoding="UTF-8"?>
<html xmlns:atv="http://webmi.atvise.com/2007/svgext" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <title></title>
  <style>v\:*{behavior:url(#default#VML)}body{overflow:hidden}</style>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
 </head>
 <body>
  <v:group atv:coordfactor="100" atv:oe="2BC6E3AA8376K2JED9HCH6G8L7N4O2GF264ADCC489H171HBKDGCO3GBM5JFPCR82" coordsize="69500,51000" id="webmivmlroot" style="height:510px;left:0;position:absolute;top:0;visibility:hidden;width:695px">
   <v:oval fillcolor="#385500" id="id_32" strokecolor="#d9cd91" stroked="true" strokeweight="3.75" style="height:800px;left:16400px;top:1900px;width:800px"/>
   <v:line fillcolor="#331967" from="57300,43100" id="id_29" strokecolor="#4e9af3" stroked="true" strokeweight="3" to="41800,18300">
    <v:stroke joinstyle="miter"/>
   </v:line>
   <v:rect fillcolor="#4db6fb" id="id_26" strokecolor="#3aa30a" stroked="true" strokeweight="1.5" style="height:30400px;left:61200px;top:19500px;width:1300px"/>
   <v:polyline fillcolor="#70f6b2" id="id_21" points="3400,26200 45500,11800 12900,44200 12500,40000 33200,18000 16700,37200 60500,19700 37900,8400 500,19400 3400,26200 " strokecolor="#13b447" stroked="true" strokeweight="2.25"/>
   <v:polyline fillcolor="#77968f" id="id_13" points="60100,47100 600,27800 57500,5500 51600,30500 54300,45300 38000,12600 1900,26900 45500,24100 " strokecolor="#f70d9a" stroked="true" strokeweight="3">
    <v:stroke joinstyle="miter"/>
   </v:polyline>
   <v:rect fillcolor="#b2571d" id="id_12" strokecolor="#117edb" stroked="true" strokeweight="1.5" style="height:20000px;left:2200px;top:29500px;width:5400px"/>
   <v:group atv:refpx="34808" atv:refpy="25881" atv:table-height="510" atv:table-width="695" coordorigin="-5200,-7600" coordsize="93900,87400" id="grid" style="height:87400px;left:-5200px;top:-7600px;width:93900px">
    <v:polyline fillcolor="#a9f378" id="id_31" points="21800,40300 63300,1800 31100,34400 61000,2700 33400,40200 53800,17900 22100,38200 33900,13000 40600,26600 13000,40800 31300,6000 22100,37400 44700,45900 21800,40300 " strokecolor="#bb13c5" stroked="true" strokeweight="3"/>
    <v:polyline fillcolor="#0b7119" id="id_30" points="44400,8600 53100,23500 7900,33200 6000,18600 11500,50400 41300,49100 44400,8600 " strokecolor="#9a1a0a" stroked="true" strokeweight="3.75"/>
    <v:rect fillcolor="#f59cc3" id="id_28" strokecolor="#09e0bc" stroked="true" strokeweight="3" style="height:16700px;left:41300px;top:1400px;width:28100px"/>
    <v:polyline fillcolor="#eb1ac8" id="id_27" points="9100,41400 27100,31100 28800,38300 34500,42000 51100,700 32400,16400 400,13400 51900,45200 52100,48700 " strokecolor="#1f34a1" stroked="true" strokeweight="0.75">
     <v:stroke joinstyle="miter"/>
    </v:polyline>
    <v:oval fillcolor="#239a5f" id="id_25" strokecolor="#a75579" stroked="true" strokeweight="0.75" style="height:16200px;left:62100px;top:18500px;width:2400px"/>
    <v:oval fillcolor="#83caac" id="id_24" strokecolor="#5dd058" stroked="true" strokeweight="2.25" style="height:36200px;left:-5200px;top:29500px;width:36200px"/>
    <v:rect fillcolor="#a578a0" id="id_23" strokecolor="#555dc5" stroked="true" strokeweight="3" style="height:6400px;left:48100px;top:27800px;width:16400px"/>
    <v:rect fillcolor="#d2ada5" id="id_22" strokecolor="#023732" stroked="true" strokeweight="2.25" style="height:10200px;left:26700px;top:18800px;width:2200px"/>
    <v:line fillcolor="#61916f" from="200,12100" id="id_20" strokecolor="#7b3d31" stroked="true" strokeweight="3" to="7200,18300">
     <v:stroke joinstyle="miter"/>
    </v:line>
    <v:polyline fillcolor="#6f6a13" id="id_19" points="7200,1500 8100,46600 18900,46700 55300,1400 10300,5400 56900,28600 7200,1500 " strokecolor="#50bb39" stroked="true" strokeweight="3.75"/>
    <v:rect atv:refpx="40000" atv:refpy="30000" class="osk-trigger" id="rect1" stroked="false" strokeweight="1" style="height:60000px;left:0px;top:0px;width:85000px"/>
    <v:oval fillcolor="#7a500e" id="id_18" strokecolor="#5d345f" stroked="true" strokeweight="3.75" style="height:5200px;left:33300px;top:32000px;width:55400px"/>
    <v:oval fillcolor="#7b6fbc" id="id_17" strokecolor="#4de26f" stroked="true" strokeweight="3" style="height:9200px;left:1000px;top:18500px;width:36200px"/>
    <v:polyline fillcolor="#60f8ea" id="id_16" points="34300,34600 27400,48400 59500,21300 50500,25100 23800,10500 36000,50700 1500,21200 3600,2800 44900,49200 49300,34400 22800,17800 54700,25500 " strokecolor="#ad64e0" stroked="true" strokeweight="0.75">
     <v:stroke joinstyle="miter"/>
    </v:polyline>
    <v:oval fillcolor="#a0f909" id="id_15" strokecolor="#d263d6" stroked="true" strokeweight="0.75" style="height:59800px;left:700px;top:20000px;width:59800px"/>
    <v:polyline fillcolor="#6d95d2" id="id_14" points="52700,6700 11500,16600 50800,25800 13800,12000 56000,41800 20900,47500 60100,8200 25900,15300 68200,39000 " strokecolor="#533d51" stroked="true" strokeweight="3">
     <v:stroke joinstyle="miter"/>
    </v:polyline>
    <v:oval fillcolor="#92c671" id="id_11" strokecolor="#72242a" stroked="true" strokeweight="0.75" style="height:34400px;left:27900px;top:24100px;width:34400px"/>
    <v:rect fillcolor="#256a74" id="id_8" strokecolor="#d08c02" stroked="true" strokeweight="3.75" style="height:21800px;left:16200px;top:7900px;width:29200px"/>
    <v:oval fillcolor="#a69c1e" id="id_7" strokecolor="#40c860" stroked="true" strokeweight="2.25" style="height:28400px;left:54000px;top:17500px;width:2400px"/>
    <v:oval fillcolor="#fd08b1" id="id_4" strokecolor="#434b3c" stroked="true" strokeweight="3.75" style="height:25400px;left:26900px;top:-7600px;width:25400px"/>
    <v:line fillcolor="#06ca72" from="63400,26900" id="id_2" strokecolor="#933432" stroked="true" strokeweight="1.5" to="15200,11900">
     <v:stroke joinstyle="miter"/>
    </v:line>
   </v:group>
  </v:group>
  <script type="text/javascript" src="../../webmi.js"></script>
  <script type="text/javascript" src="/q/TableFunctions.js"></script>
  <script type="text/javascript" src="/q/StdConstantsFunctions.js"></script>
  <script type="text/javascript">//<![CDATA[
webMI.proxy({"":[function(webMI,window,document,self){var $ = top.$;
var headers = [];
var linefill = "#FFFFFF";
var nodearray = [];
var atviseTable;
var paramList;
var col_dp = 4;
getRow = function(dp)
{
	var curData = atviseTable.dataProvider().source.data;
	for (var i=0; i<curData.length; i++) {	
		if(curData[i][1].dp == dp)
			return i +1;
	}
}


// setup blank table
atviseTable = webMI.callExtension("SYSTEM.LIBRARY.ATVISE.QUICKDYNAMICS.Table", { "gElement": document.getElementById("grid"), "sortedByColumn":0, "autoResize":true, "height":510, "width":695});

atviseTable.setConfiguration({rowHeight:35,sortingUp:true,autoResize:true, drawStatusBar:false});
headers.push({name: "Parameter", width: 280, fontSize: fontSize});
headers.push({name: "Value", width: 220, fontSize: fontSize});
headers.push({name: "Type", width: 100, fontSize: fontSize});
headers.push({name: "Set", width: 64, fontSize: fontSize});
headers.push({name: "", width: 1, fontSize: fontSize});

atviseTable.setHeaders(headers);

// - - - - - - - - - - - -

webMI.addOnload(function(f){
	webMI.trigger.fire("RequestParameterList");		
});

// - - - - - - - - - - - -


webMI.trigger.connect("SetParameterList", function(e){

	paramList = e.value[0];
	var task = e.value[1];
	var prefix = e.value[2];

//	console.log("Received parameter list: ", paramList);

	//initialize table
	for (var i=0; i<paramList.length; i++) {	
//		console.log("=====================================Looking at : ", paramList[i]);
		var datarow = [];
		var fullyQualifiedDP = "/"+task+"/"+prefix+paramList[i].DP;

		datarow[0] = {text: paramList[i].ParamName, fill:linefill, fontSize: fontcolumn};
		datarow[1] = {text: "...", fill:linefill, dp:fullyQualifiedDP, fontSize: fontcolumn};
		datarow[2] = {text: paramList[i].Type, fill:linefill, fontSize: fontcolumn};
		var eventList = [{name: "click", fn: getWriteFunction(fullyQualifiedDP, paramList[i].Type)}];
		datarow[3] = {text: "SET", fill:linefill, eventList: eventList, fontSize: fontcolumn};
		//datarow[4] = {text: fullyQualifiedDP, fill:linefill};
		nodearray[i] = datarow;	
	}
	atviseTable.setDataProvider({data: nodearray});

	//Set Update Function
	for (var i=0; i<paramList.length; i++) {
		var fullyQualifiedDP = "/"+task+"/"+prefix+paramList[i].DP;
		addSubscribe(2, getRow, fullyQualifiedDP, paramList[i].Type, atviseTable);
	}
});
//on screen keyboard
/*var table = document.getElementById("grid");
	table.onScreenKeyboard({
					rewireReturn : 'submit',
					rewireTab : true
				});
*/

webMI.callExtension("SYSTEM.LIBRARY.PROJECT.QUICKDYNAMICS.Theme", {"action":"font family", "defaultValue":"font family", "id":"grid", "key":"FontFamily", "property":""});
},{},{}]},window);
//]]></script>
 </body>
</html>
