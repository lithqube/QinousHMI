<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<svg width="430" version="1.2" xmlns="http://www.w3.org/2000/svg" height="280" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:atv="http://webmi.atvise.com/2007/svgext">
 <defs/>
 <desc>Simple display that can be used as dialog to login.</desc>
 <title>Login dialog</title>
 <metadata>
  <atv:gridconfig width="20" enabled="true" height="20" gridstyle="lines"/>
  <atv:snapconfig width="10" enabled="true" height="10"/>
 </metadata>
 <rect width="430" x="0" y="0" fill="#1e1e1e" height="280" stroke="none" id="background" atv:refpx="215" stroke-width="0" atv:refpy="140"/>
 <rect width="390" x="20" y="140" fill="#444444" rx="10" height="50" ry="10" stroke="none" id="id_13" atv:refpx="-186.142" stroke-width="0" atv:refpy="95"/>
 <rect width="390" x="20" y="84" fill="#444444" rx="10" height="50" ry="10" stroke="none" id="username_background" atv:refpx="215" stroke-width="0" atv:refpy="115"/>
 <svg width="80" x="190" y="240" atv:dynamic="true" height="30" xlink:href="SYSTEM.LIBRARY.ATVISE.OBJECTDISPLAYS.Standard.button" id="ok_button" atv:refpx="230" atv:refpy="255">
  <atv:argument value="T{OK}" name="label"/>
  <atv:argument value="5" name="tabIndex"/>
 </svg>
 <svg width="80" x="280" y="240" atv:dynamic="true" height="30" xlink:href="SYSTEM.LIBRARY.ATVISE.OBJECTDISPLAYS.Standard.button" id="cancel_button" atv:refpx="320" atv:refpy="255">
  <atv:argument value="T{Cancel}" name="label"/>
  <atv:argument value="6" name="tabIndex"/>
 </svg>
 <svg width="160" x="151.111" y="100" height="30" xlink:href="SYSTEM.LIBRARY.ATVISE.OBJECTDISPLAYS.Standard.in_out_value" id="username_input" atv:refpx="260" atv:refpy="115" transform="matrix(1.125,0,0,1,0,0)">
  <atv:argument value="String" name="validation"/>
  <atv:argument value="Yes" name="allowDirectInput"/>
  <atv:argument value="1" name="tabIndex"/>
  <atv:overwrite x="171.5" id="input_label" transform="matrix(0.8889,0,0,1,0,0)"/>
  <atv:overwrite width="172" id="input_bg" transform="matrix(0.8889,0,0,1,0,0)"/>
  <atv:overwrite width="174.5" id="id_2" transform="matrix(0.8889,0,0,1,0,0)"/>
  <atv:overwrite width="179.5" id="id_0" transform="matrix(0.8889,0,0,1,0,0)"/>
 </svg>
 <svg width="160" x="151.111" y="150" height="30" xlink:href="SYSTEM.LIBRARY.ATVISE.OBJECTDISPLAYS.Standard.in_out_value" id="password_input" atv:refpx="260" atv:refpy="165" transform="matrix(1.125,0,0,1,0,0)">
  <atv:argument value="String" name="validation"/>
  <atv:argument value="Yes" name="password"/>
  <atv:argument value="Yes" name="allowDirectInput"/>
  <atv:argument value="3" name="tabIndex"/>
  <atv:overwrite x="171.5" id="input_label" transform="matrix(0.8889,0,0,1,0,0)"/>
  <atv:overwrite width="172" id="input_bg" transform="matrix(0.8889,0,0,1,0,0)"/>
  <atv:overwrite width="174.5" id="id_2" transform="matrix(0.8889,0,0,1,0,0)"/>
  <atv:overwrite width="179.5" id="id_0" transform="matrix(0.8889,0,0,1,0,0)"/>
 </svg>
 <text x="34" y="119.5" fill="#ffffff" font-family="Arial" id="username_label" atv:refpx="79.5" atv:refpy="113.5" font-size="16">T{Username}</text>
 <text x="34" y="169.5" fill="#ffffff" font-family="Arial" id="password_label" atv:refpx="78.5" atv:refpy="163.5" font-size="16">T{Password}</text>
 <text x="122" y="48.5" fill="#ffffff" font-family="Arial" text-anchor="start" id="status_message" atv:refpx="256" atv:refpy="44" font-size="12">T{Please enter username, password and group.}</text>
 <svg width="80" x="960" y="100" atv:dynamic="true" height="30" xlink:href="SYSTEM.LIBRARY.ATVISE.OBJECTDISPLAYS.Standard.button" id="username_keyboard" atv:refpx="375" atv:refpy="115" transform="matrix(0.375,0,0,1,0,0)">
  <atv:argument value="SYSTEM.LIBRARY.ATVISE.OBJECTDISPLAYS.Symbols.20x20.keyboard" name="symbol"/>
  <atv:argument value="inherit" name="visibilitySymbol"/>
  <atv:argument value="hidden" name="visibilityLabel"/>
  <atv:argument value="2" name="tabIndex"/>
  <atv:overwrite width="22" id="button_stroke" transform="matrix(2.6667,0,0,1,0,0)"/>
  <atv:overwrite x="15" id="button_label" transform="matrix(2.6667,0,0,1,0,0)"/>
  <atv:overwrite x="5" id="button_symbol" transform="matrix(2.6667,0,0,1,0,0)"/>
  <atv:overwrite width="22" id="button_bg" transform="matrix(2.6667,0,0,1,0,0)"/>
  <atv:overwrite width="24.5" id="id_2" transform="matrix(2.6667,0,0,1,0,0)"/>
  <atv:overwrite width="29.5" id="id_0" transform="matrix(2.6667,0,0,1,0,0)"/>
 </svg>
 <svg width="80" x="960" y="150" atv:dynamic="true" height="30" xlink:href="SYSTEM.LIBRARY.ATVISE.OBJECTDISPLAYS.Standard.button" id="password_keyboard" atv:refpx="375" atv:refpy="165" transform="matrix(0.375,0,0,1,0,0)">
  <atv:argument value="SYSTEM.LIBRARY.ATVISE.OBJECTDISPLAYS.Symbols.20x20.keyboard" name="symbol"/>
  <atv:argument value="inherit" name="visibilitySymbol"/>
  <atv:argument value="hidden" name="visibilityLabel"/>
  <atv:argument value="4" name="tabIndex"/>
  <atv:overwrite width="22" id="button_stroke" transform="matrix(2.6667,0,0,1,0,0)"/>
  <atv:overwrite x="15" id="button_label" transform="matrix(2.6667,0,0,1,0,0)"/>
  <atv:overwrite x="5" id="button_symbol" transform="matrix(2.6667,0,0,1,0,0)"/>
  <atv:overwrite width="22" id="button_bg" transform="matrix(2.6667,0,0,1,0,0)"/>
  <atv:overwrite width="24.5" id="id_2" transform="matrix(2.6667,0,0,1,0,0)"/>
  <atv:overwrite width="29.5" id="id_0" transform="matrix(2.6667,0,0,1,0,0)"/>
 </svg>
 <svg width="60" x="40" y="10" visibility="hidden" height="60" xlink:href="SYSTEM.LIBRARY.ATVISE.OBJECTDISPLAYS.Symbols.60x60.prohibition_sign_grey" id="status_symbol" atv:refpx="70" atv:refpy="40"/>
 <text x="34" y="219.5" fill="#ffffff" font-family="Arial" id="id_1" atv:refpx="65" atv:refpy="213.5" font-size="16">T{Group}</text>
 <svg width="80" x="960" y="200" atv:dynamic="true" height="30" xlink:href="SYSTEM.LIBRARY.ATVISE.OBJECTDISPLAYS.Standard.button" id="id_3" atv:refpx="375" atv:refpy="215" transform="matrix(0.375,0,0,1,0,0)">
  <atv:argument value="SYSTEM.LIBRARY.ATVISE.OBJECTDISPLAYS.Symbols.20x20.keyboard" name="symbol"/>
  <atv:argument value="inherit" name="visibilitySymbol"/>
  <atv:argument value="hidden" name="visibilityLabel"/>
  <atv:argument value="2" name="tabIndex"/>
  <atv:overwrite width="22" id="button_stroke" transform="matrix(2.6667,0,0,1,0,0)"/>
  <atv:overwrite x="15" id="button_label" transform="matrix(2.6667,0,0,1,0,0)"/>
  <atv:overwrite x="5" id="button_symbol" transform="matrix(2.6667,0,0,1,0,0)"/>
  <atv:overwrite width="22" id="button_bg" transform="matrix(2.6667,0,0,1,0,0)"/>
  <atv:overwrite width="24.5" id="id_2" transform="matrix(2.6667,0,0,1,0,0)"/>
  <atv:overwrite width="29.5" id="id_0" transform="matrix(2.6667,0,0,1,0,0)"/>
 </svg>
 <svg width="160" x="151.111" y="200" height="30" xlink:href="SYSTEM.LIBRARY.ATVISE.OBJECTDISPLAYS.Standard.in_out_value" id="group_input" atv:refpx="260" atv:refpy="215" transform="matrix(1.125,0,0,1,0,0)">
  <atv:argument value="0" name="min"/>
  <atv:argument value="15" name="max"/>
  <atv:overwrite x="171.5" id="input_label" transform="matrix(0.8889,0,0,1,0,0)"/>
  <atv:overwrite width="172" id="input_bg" transform="matrix(0.8889,0,0,1,0,0)"/>
  <atv:overwrite width="174.5" id="id_2" transform="matrix(0.8889,0,0,1,0,0)"/>
  <atv:overwrite width="179.5" id="id_0" transform="matrix(0.8889,0,0,1,0,0)"/>
 </svg>
 <script type="text/ecmascript"><![CDATA[var trigger_username = "com.atvise.login.username";
var trigger_password = "com.atvise.login.password";
var username = "";
var password = "";
var group = 0;


webMI.addOnload(function(e) {
	webMI.trigger.fire("setValue", "", "username_input");
	webMI.trigger.fire("setValue", "", "password_input");
	webMI.trigger.fire("setValue", 0, "group_input");
});

webMI.trigger.connect("valuechanged", function(e) {
	username = e.value;
}, "username_input");

webMI.trigger.connect("valuechanged", function(e) {
	password = e.value;
}, "password_input");

webMI.trigger.connect("valuechanged", function(e) {
	group = e.value;
}, "group_input");

webMI.trigger.connect(trigger_username, function(e) {
	username = e.value;
	webMI.trigger.fire("setValue", e.value, "username_input");
});

webMI.trigger.connect(trigger_password, function(e) {
	password = e.value;
	webMI.trigger.fire("setValue", e.value, "password_input");
});



webMI.trigger.connect("clicked", function(e) {
	webMI.display.closeWindow();
}, "cancel_button");

webMI.trigger.connect("clicked", function(e) {
	webMI.data.call("login_AddUser", {"Username": username, "Password": password, "Group": group}, function(e) {
		if (e && e.ret != 0){
			webMI.gfx.setText("status_message", "T{AddUser failed! ret="+e.ret+"}");
			webMI.gfx.setVisible("status_symbol", null);
		} 
		else if (e && e.ret == 0){
			webMI.gfx.setText("status_message", "T{User "+username+" added.}");
			webMI.gfx.setVisible("status_symbol", false);
		}
		else {
			webMI.display.closeWindow();
		}
	});
}, "ok_button");

webMI.trigger.connect("clicked", function(e) {
	webMI.query.trigger = trigger_username;
	webMI.query.password = "No";
	webMI.query.value = "";
	webMI.display.openWindow({display:"SYSTEM.LIBRARY.ATVISE.OBJECTDISPLAYS.Standard.keyboard.keyboard",extern:false,height:250,menubar:false,modal:true,movable:true,resizable:false,scrollbars:false,status:false,title:"Keyboard",toolbar:false,width:550,query:webMI.query});
}, "username_keyboard");

webMI.trigger.connect("clicked", function(e) {
	webMI.query.trigger = trigger_password;
	webMI.query.password = "Yes";
	webMI.query.value = "";
	webMI.display.openWindow({display:"SYSTEM.LIBRARY.ATVISE.OBJECTDISPLAYS.Standard.keyboard.keyboard",extern:false,height:250,menubar:false,modal:true,movable:true,resizable:false,scrollbars:false,status:false,title:"Keyboard",toolbar:false,width:550,query:webMI.query});
}, "password_keyboard");]]></script>
</svg>
